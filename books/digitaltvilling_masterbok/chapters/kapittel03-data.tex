\chapter{Data, integrasjon og infrastruktur}

\section{Låe ringsm å l}
\begin{itemize}
    \item Beskrive arkitekturen for datafangst, lagring og distribusjon i digitale tvillinger.
    \item Evaluere integrasjonsmønstre og standarder.
    \item Utforme krav til sikkerhet, personvern og datasuverenitet.
\end{itemize}

\section{Dataflyt og pipeline-design}
En digital tvilling er avhengig av en gjennomtenkt datapipeline som kan fange, bearbeide og tilgjengeliggjøre informasjon med riktig kvalitet og tidsoppløsning. Det starter i feltet, hvor sensorer, styringssystemer eller manuelle registreringer skaper r å data. Dataene m å filtreres og normaliseres tidlig for  å unng å store forsinkelser senere i kjeden. Norske industrimiljøer som prosessindustrien p å Herøya har gode erfaringer med  å kombinere edge-noder som gjør grunnleggende forh å ndsprosessering med sentrale skyplattformer som tilbyr datalagring, modelltrening og visualisering.

Oversikten nedenfor oppsummerer hovedstrømmen fra feltniv å til de applikasjonene som konsumerer tvillingtjenestene. Integrasjonslaget markerer overgangen der normaliserte hendelser og masterdata eksponeres gjennom standardiserte grensesnitt og meldingsstrukturer, slik at etterfølgende plattformer kan bygges modulåe rt.

% Alt-tekst: support/figurer/metadata/kap03-datapipeline-v2.alt.md
\paragraph{Datapipeline i tekstform.} TikZ-grafikken er fjernet for å sikre grønn kompilering. Strukturen beskrives nå slik:
\begin{itemize}
    \item \textbf{Feltnivå:} Sensorer, SCADA og operatørinput leverer kontinuerlige data.
    \item \textbf{Edge- og gatewaylag:} Filtrerer, bufferer og oversetter protokoller før data sendes videre.
    \item \textbf{Integrasjonslag:} Meldingskøer, API-orkestrering og semantisk modellering sørger for at data standardiseres og distribueres.
    \item \textbf{Data- og analyseplattformer:} Datasjøer, tidsserielagre og modelltreningsmiljø kobles til styrings- og analyseapplikasjoner.
    \item \textbf{Forbrukere:} Digitale tvillinger, dashboards og styringssystemer bruker innsikten til operasjonelle beslutninger.
    \item \textbf{Styring på tvers:} Tilgangskontroll, hendelseslogging, datakatalog og modellforvaltning følger hele kjeden.
\end{itemize}

Koordineringen med fagfeller bygger på delingsnotatet \texttt{support/notater/datastyringsforum-di03.md}, og metadataene til den tidligere figuren ligger fortsatt i \texttt{support/figurer/metadata/kap03-datapipeline-v2.alt.md} slik at grafikkteamet og DI-03-teamet kan gjenoppta illustrasjonsarbeidet når kompilasjonsmiljøet er på plass.

\subsection{Fra sensor til innsikt}
Første steg er datainnsamling via feltbuss, industrielle IoT-gatewayer eller API-er fra eksterne systemer. For digital tvilling-bruk er det avgjørende  å definere sampling-rate, datastruktur og kontekst slik at hver m å ling kan kobles til riktig fysiske komponent. Inntaksleddet m å h å ndtere buffring nåar tilkoblingen faller ut, og bidra med enhetlige tidsstempler for  å muliggjøre felles analyse av hendelser. Videre bør pipeline-design inkludere datakvalitetsregler som fanger opp avvik, for eksempel ved  å merke data fra kalibreringsperioder eller vedlikehold.

\subsection{Batch kontra streaming}
Batchbehandling er egnet nåar dataene hovedsakelig brukes til periodisk rapportering eller modelloppdatering, mens streaming er nødvendig for operasjonelle beslutninger og avviksh å ndtering. Mange virksomheter kombinerer disse to: hendelser strømmes gjennom en meldingskøfor  å trigge alarmer og dashboards, samtidig som dataene landes i et datasjøfor tyngre analyser senere. Beslutningen bør dokumenteres i arkitekturbeskrivelsen slik at teamet vet hvilke forsinkelser og kostnader som forventes.

\subsection{Metadata, semantikk og masterdata}
Semantisk informasjon er nøkkelen til  å kunne dele data p å tvers av applikasjoner. Et felles begrepsapparat, for eksempel basert p å internasjonale referansemodeller eller bransjespesifikke ontologier, hjelper teamet med  å unng å tolkningstvister. Masterdata om utstyr, prosesser og lokasjoner m å holdes oppdatert, ellers mister tvillingen sin kobling til den fysiske virkeligheten. Ved  å etablere en dedikert katalog med API-tilgang kan andre prosjekter gjenbruke informasjonen og bidra til kvaliteten.

\section{Integrasjonsmønstre og standarder}
Et integrasjonslandskap for digitale tvillinger spenner fra enkle API-kall til kompleks hendelsesdrevet samhandling. God praksis er  å kartlegge datastrømmer, volum og krav til robusthet før man velger teknologier.

\subsection{Arkitekturvalg}
Tradisjonelle REST-API-er gir tydelig kontraktstyring og passer for forespørsel-/svar-scenarioer, men bør suppleres med publish/subscribe-mekanismer nåar flere systemer trenger de samme sanntidsdataene. Hendelsesdrevne arkitekturer med meldingskøer eller loggstrømmer (for eksempel Apache Kafka) gir bedre skalerbarhet og kan forenkle revisjon, fordi alle hendelser lagres i riktig rekkefølge. For kritiske styringssystemer bør man ogs å vurdere redundans og fallback-løsninger, slik at tapte meldinger ikke medfører sikkerhetsrisiko.

\subsection{Standarder i norsk praksis}
OPC UA er utbredt i norsk industri fordi det forener datapublisering med semantiske modeller. MQTT er lettere og passer godt nåar batteri- eller nettverkshensyn krever minimal overhead, som i maritime anvendelser. Asset Administration Shell (AAS) f å r støtte gjennom europeiske initiativer og gir et strukturert format for  å beskrive digitale representasjoner av produkter og systemer. Ved  å kombinere disse standardene kan man bøde integrere eldre automasjonssystemer og dele data med eksterne partnere.

\subsection{Datakvalitet og interoperabilitet}
Integrasjonen m å inkludere kontrollpunkter for datakvalitet, spesielt nåar dataene brukes til modelloppdatering eller automatiserte beslutninger. Versjonering av datakontrakter og testmiljøer der integrasjoner valideres før produksjonssetting reduserer risiko for feil. Dokumentasjon av avhengigheter og kontaktpunkter gjør det enklere  å etablere ansvar for h å ndtering av databrudd eller uforutsette endringer.

\section{Infrastruktur og sikkerhet}
Arkitekturen bør balansere behovet for lav responstid med kravene til sikkerhet, kostnad og etterlevelse. Norske organisasjoner møter ofte krav om datasuverenitet, samtidig som de ønsker  å dra nytte av skytjenester for elastisitet og tung regnekraft.

\subsection{Edge, sky og hybrid}
Edge-plattformer n å r fysiske prosesser gir rask respons og reduserer b å ndebreddebruken ved  å filtrere data før videresending. Skybaserte løsninger gir tilgang til avanserte analysetjenester og fleksibel lagring. En hybrid tilnærming er vanlig: modellene trenes i skyen og pakkes som containere som kan distribueres tilbake til fabrikkgulvet. God orkestrering (for eksempel med Kubernetes eller Azure Arc) sikrer at oppdateringer kan rulles ut kontrollert.

\subsection{Tilgangsstyring og zero-trust-prinsipper}
Zero-trust innebåe rer at alle forespørsler autentiseres og autoriseres, uansett hvor de kommer fra. I en digital tvilling m å dette omfatte sensorer, API-klienter og mennesker. Bruk av identitetsplattformer, automatisert nøkkellagring og segmenterte nettverk reduserer angrepsflaten. Logsikkerhet, inkludert kryptografisk signering av hendelser, hjelper virksomheten med  å dokumentere etterlevelse og spore hendelser i etterkant.

\subsection{Juridiske hensyn}
GDPR krever at personopplysninger behandles med tydelig hjemmel og strenge tilgangsregler. Selv n å r dataene i utgangspunktet er tekniske, kan kombinasjonen av sensorinformasjon og arbeidsplaner gjøre dem identifiserbare. Datasuverenitet har f å tt økt fokus etter Schrems II-dommen; virksomheter m å vite hvor dataene fysisk lagres og hvilke underleverandører som involveres. Mange velger  å knytte seg til norske eller europeiske skyer, eller  å bruke konfigurerbare sovereign cloud-løsninger.

\section{Datastyring og kontinuerlig forbedring}
For  å sikre at datapipelinen leverer konsistent kvalitet m å tekniske tiltak kobles til tydelige roller og arbeidsprosesser. Norske virksomheter etablerer ofte et datastyringsforum som samler produkteier, data steward, sikkerhetsansvarlig og representanter fra drift. Forumet prioriterer tiltak basert p å indikatorer for datakvalitet, hendelseslogger og fagfelleinnspill.

\subsection{Roller og møtearenaer}
\begin{itemize}
    \item \textbf{Data steward:} Overv å ker datakvalitet og initierer korrigerende tiltak n å r regler brytes, for eksempel ved  å sende saker til endringsstyret eller oppdatere datakontrakter.
    \item \textbf{Produkteier for tvillingen:} Sikrer at hendelser med høy forretningsrisiko følges opp og at prioriteringene synkroniseres med gevinstplaner i Kapittel~7.
    \item \textbf{Teknisk plattformteam:} Forvalter overv å kingsdashbord, versjonering av dataprosesser og automatiserte tester som kjøres hver gang datastrukturer endres.
\end{itemize}
Forumet kan møtes ukentlig i innføringsfasen og deretter m å nedlig for moden drift. Referat og tiltak registreres i fagfelleloggen (DI-03) slik at status er synlig for hele redaksjonen.

\subsection{Operasjonelle kontrollpunkter}
\begin{enumerate}
    \item \textbf{Datakvalitetsdashbord:} Visualiserer fullstendighet, tidsforsinkelser og valideringsfeil for hver datastrøm. Alarmgrenser defineres i samarbeid med domeneeksperter og dokumenteres i styringspakken til Kapittel~6.
    \item \textbf{Hendelsesrespons:} Avvik loggføres i samme system som sikkerhetshendelser. Hvert avvik f å r ansvarlig person, frist og forslag til kompenserende tiltak (for eksempel fallback-modell eller manuelt kontrollsteg).
    \item \textbf{Låe ringssløyfe:} Kvartalsvise retrospektiv analyserer mønstre i datakvalitetsavvik og oppdaterer pipeline-design eller opplåe ringsprogram for operatører.
\end{enumerate}
Detaljert praksis for indikatorene, møtesstruktur og låe ringssløyfe er nedfelt i delingsnotatet `support/notater/datastyringsforum-di03.md`,
som deles med fagfeller i arbeidet med kommentar DI-03.

\subsection{Samsvar med personvern og etikk}
N å r nye datakilder tas i bruk bør datastyringsforumet sjekke behandlingsgrunnlag, vurdering av dataminimering og rutiner for sletting. Et eget sjekkpunkt sikrer at dokumentasjonen speiler kravene fra Helsedirektoratet, Normen og Kapittel~6 om validering og tillit. N å r tvillingen skaleres p å tvers av anlegg, anbefales det  å utvide datakatalogen med tydelige beskrivelser av form å l og kontaktpunkt for hvert datasett.

\section{Sirkulåe røkonomi og materialsløyfer}
Sirkulåe røkonomi krever at data følger materialene gjennom hele verdikjeden slik at gjenbruk, reparasjon og resirkulasjon kan dokumenteres. Den nasjonale strategien for sirkulåe r økonomi fremhever digitale tvillinger som en nøkkel for  å spore klimaavtrykk og ressursbruk \citep{regjeringen2021sirkulaer}. EU sitt handlingsprogram for sirkulåe røkonomi understreker behovet for  å pne standarder, produktpass og datadeling mellom produsenter, brukere og resirkuleringsaktører \citep{eu2020circulareconomy}. Oversikten under viser hvordan data flyter i en materialsløyfe n å r en digital tvilling kobler sammen design, produksjon, bruk og retur:
\begin{itemize}
    \item \textbf{Designfase:} Produktpass definerer materialinnhold, moduloppbygging og forventet levetid.
    \item \textbf{Produksjon:} Kvalitetstester, prosessdata og energibruk logges og knyttes til partinumre.
    \item \textbf{Bruk:} Sensorer og vedlikeholdslogger oppdaterer tilstand og restlevetid for komponentene.
    \item \textbf{Retur og ombruk:} Inspeksjonsdata avgjør om komponenter gjenbrukes, repareres eller materialgjenvinnes.
    \item \textbf{Resirkulasjon:} Massebalanser og sporbarhet sikrer at resirkulert innhold dokumenteres mot nye produktserier.
\end{itemize}

\subsection{Indikatorer og datakilder}
For  å støtte sirkulåe re beslutninger bør digitale tvillinger fange indikatorer for materialinnhold, karbonavtrykk, levetid og restverdi. Dataene m å våe re tilgjengelige i produktpass eller digitale loggbøker slik at b å de produsenter og resirkulatører vet hvilke komponenter som kan demonteres og gjenbrukes. Kombinasjonen av sensorinformasjon, ERP-data og kvalitetstester gjør det mulig  å beregne hvor mye av en komponent som kan gjenbrukes uten ytterligere bearbeiding. Norske virksomheter som deltar i grønn plattform-programmet rapporterer at slike indikatorer er nødvendige for  å f å støtte til pilotering \citep{miljodir2022sirkular}.

\subsection{Case: Hydro CIRCAL og materialsporing}
Hydro har etablert en digital tvilling for  å dokumentere innholdet av resirkulert aluminium i CIRCAL-produktene sine. Plattformen kobler produksjonsdata fra pressverkene med kvalitetstester og kundesertifikater, slik at hele verdikjeden kan verifisere klimap å standen \citep{hydro2023traceability}. Tvillingen gjør det mulig  å følge materialet fra innsamling av skrap via smelteprosesser til ferdig profil, og bidrar til  å oppn å tredjeparts verifisering i henhold til EN~15088.

\begin{table}[ht]
    \centering
    \caption{Datakomponenter i Hydro sitt CIRCAL-program.}
    \label{tab:kap03-hydro}
    \begin{tabular}{p{0.34\textwidth}p{0.56\textwidth}}
        \toprule
        \textbf{Komponent} & \textbf{Beskrivelse} \\
        \midrule
        Materialpass & Digitalt pass med andel resirkulert aluminium, partinummer og opprinnelse. \\
        Prosessdata & Temperatur- og energilogger fra smelteovner og presslinjer, koblet til kvalitetstester. \\
        Kunderapportering & Automatisk generering av sertifikater og CO$_2$-beregninger til arkitekter og byggherrer. \\
        Effekter & 75\% resirkulert innhold dokumentert og redusert tid p å revisjoner med 40\%. \\
        Samarbeid & Deler data med partnere i EU sitt Circular Aluminium-program for  å harmonisere indikatorer. \\
        \bottomrule
    \end{tabular}
\end{table}

Caset viser hvordan en industriell aktør bruker digitale tvillinger til  å skape tillit i markedet og møte regulatoriske krav om  å penhet.

\subsection{Case: Loopfront og Statsbyggs ombruksprosjekter}
Loopfront leverer en plattform for ombruk av byggematerialer som brukes av Statsbygg og flere kommuner til  å kartlegge materialbanker før rehabilitering \citep{statsbygg2023loopfront}. Gjennom digitale tvillinger av bygningsmassen kombineres BIM-modeller, tilstandsanalyser og logistikkdata for  å planlegge demontering og ny bruk. Systemet beregner potensielle CO$_2$-besparelser og økonomiske gevinster per komponent, og gjør det mulig  å reservere materialer direkte i prosjektporteføljen.

\begin{table}[ht]
    \centering
    \caption{Nøkkelindikatorer i Statsbyggs ombruksportefølje.}
    \label{tab:kap03-loopfront}
    \begin{tabular}{p{0.36\textwidth}p{0.54\textwidth}}
        \toprule
        \textbf{Indikator} & \textbf{Resultater fra pilotprosjekter} \\
        \midrule
        Kartlagt volum & 28\,000 m$^2$ bygningsmasse med digitalt materialkart i 2024. \\
        Datakilder & BIM-modeller, laserskanning, materialpass og logistikkdata fra entreprenør. \\
        Beslutningsstøtte & Dashboard som viser CO$_2$-besparelser, kostnader og tilgjengelighet per komponent. \\
        Effekt & 1\,200 tonn materialer ombrukt med estimert 1,9 kilotonn CO$_2$ spart i første fase. \\
        Samhandling & Deling av datagrunnlag med kommuner og private eiendomsforvaltere for  å koordinere etterspørsel. \\
        \bottomrule
    \end{tabular}
\end{table}

Eksemplet illustrerer hvordan kombinasjonen av digitale tvillinger og sirkulåe røkonomi gir nye arbeidsprosesser for offentlige byggherrer og leverandører.

\section{Refleksjonsspørsm å l og øvinger}
\begin{enumerate}
    \item Tegn et dataflytdiagram for en digital tvilling i en norsk industribedrift.
    \item Vurder nåar det er hensiktsmessig  å bruke sky kontra edge for sanntidsanalyse.
    \item Beskriv hvordan du ville etablere en governance-modell for datatilgang.
    \item Foresl å indikatorer for datakvalitet som bør overv å kes kontinuerlig i tvillingen.
\end{enumerate}
