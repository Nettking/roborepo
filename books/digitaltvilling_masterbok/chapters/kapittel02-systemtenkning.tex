\chapter{Systemtenkning og modellering}


\section{Læringsmål}
\begin{itemize}
    \item Analysere komplekse systemer ved hjelp av systemtenkning.
    \item Vurdere ulike modelleringsstrategier for digitale tvillinger.
    \item Beskrive hvordan modeller kobles til måledata og styringssystemer.
\end{itemize}

\section{Systemperspektiv}
Systemtenkning starter med å forstå hvilke deler av virkeligheten som påvirker hverandre og hvordan verdistrømmer beveger seg gjennom systemet. Første steg er å definere klare systemgrenser, identifisere interessenter og beskrive hva de forsøker å oppnå. Deretter kan vi visualisere samspillet mellom teknologi, prosesser og mennesker ved hjelp av systemkart, påvirkningsdiagrammer og kausale sløyfer. Beskrivelsene under gir to typiske fremstillinger for en digital tvilling i en norsk industribedrift.

\textbf{Nøkkelspørsmål når systemperspektivet etableres:}
\begin{itemize}
    \item Hvilke organisatoriske enheter og tekniske komponenter inngår i systemet?
    \item Hvilke datakilder, beslutninger og tilbakemeldingsløp knytter dem sammen?
    \item Hvilke målkonflikter kan oppstå mellom interessentene?
\end{itemize}

\subsection{Systemkart for produksjonslinje med digital tvilling}
% Alt-tekst: support/figurer/metadata/kap02-systemkart-v2.alt.md
\paragraph{Systemkart som tekst.} For å eliminere kompilasjonsfeil erstattes TikZ-grafikken med en strukturert tekstforklaring. Systemkartet består av følgende lag:
\begin{itemize}
    \item \textbf{Feltnivå:} Sensorer, pumper, ventiler og andre fysiske komponenter som leverer sanntidsdata.
    \item \textbf{Edge-infrastruktur:} Lokale noder som filtrerer data, utfører hurtige analyser og sikrer robust kommunikasjon.
    \item \textbf{Produksjonsstyring:} MES- og SCADA-lag som koordinerer operasjoner og gjør data tilgjengelig for analyse.
    \item \textbf{Analyse- og tvillingtjenester:} Skyplattformer og beslutningsgrensesnitt som kombinerer historikk og sanntidsinformasjon.
    \item \textbf{Brukergrupper:} Operatører, vedlikeholdsteam og ledelse som mottar innsikt og foreslåtte tiltak.
\end{itemize}

Beskrivelsen over viser et typisk informasjonsløp der feltnivå, edge-infrastruktur og produksjonsstyringssystemer er tydelig gruppert. Når lagene omtales eksplisitt, blir ansvarsdelingen enklere å lese enn i en kompakt figur. Historiske data kombineres med analyseplattformen for å oppdatere den digitale tvillingen, som igjen leverer beslutningsstøtte til operatører, vedlikeholdsteam og ledelse. Når du lager et eget systemkart, noter eksplisitt hvilke datatyper som flyter mellom nodene, og marker hvor ansvar og eierskap ligger i hvert lag.

\subsection{Kausalsløyfe mellom vedlikehold og energibruk}
% Alt-tekst: support/figurer/metadata/kap02-kausal-v1.alt.md
\paragraph{Kausalsammenhenger forklart i tekst.} Fremfor en grafisk sløyfe beskrives koblingene slik:
\begin{itemize}
    \item Mer planlagt vedlikehold gir bedre sensordata og færre uforutsette stopp.
    \item Stabil drift reduserer energiforbruket og forbedrer produktkvaliteten.
    \item Høy produktkvalitet frigjør tid til videre læring og justering av vedlikeholdsstrategien.
    \item Operasjonelle erfaringer føres tilbake som tiltak i styringssystemene.
\end{itemize}

Denne tekstlige sløyfen viser hvordan systemkart kan brukes til å fange både ønskede og uønskede tilbakemeldinger. Økt planlagt vedlikehold forbedrer sensorenes status, som reduserer risiko for uplanlagte stopp og stabiliserer energibruken. Et stabilt energinivå gir høyere produktkvalitet, noe som igjen påvirker vedlikeholdsstrategien gjennom læring og prioritering av tiltak. Når slike forhold beskrives eksplisitt, blir det enklere å diskutere scenarier med interessenter og identifisere hvor den digitale tvillingen bør levere mest verdi.

\textbf{Arbeidsmåte for å utvikle systemkart:}
\begin{enumerate}
    \item Start med en workshop hvor interessenter beskriver mål og smertepunkter.
    \item Tegn det overordnede systemkartet (slik det er beskrevet i punktlisten over) med fokus på dataflyt og ansvar.
    \item Utvid kartet med kausale sløyfer (slik tekstbeskrivelsen over viser) for å avdekke dynamikk og mulige ubalanser.
    \item Forankre kartene i virksomhetens enterprise-arkitektur og eksisterende prosesskart slik at språk og symboler er gjenkjennelige for organisasjonen.
\end{enumerate}

Den konseptuelle modellen fra systemkartet danner grunnlaget for videre modellering, enten du velger fysikkbaserte, datadrevne eller hybride tilnærminger i de følgende seksjonene.

\section{Modelleringsparadigmer}
Systemkartet gir en felles forståelse av hvilke fenomener som må representeres i en digital tvilling. Neste steg er å velge et
modelleringsparadigme som balanserer nøyaktighet, forklarbarhet og implementasjonskostnad. Masterstudenter må kunne vurdere
hvordan ulike typer modeller beskriver sammenhengene i systemet og hvilke beslutninger de støtter. I praksis innebærer dette å
kombinere domenekunnskap fra feltet med metoder fra matematikk, statistikk og informatikk.

\subsection{Fysikkbaserte modeller}
Fysikkbaserte modeller er bygd på eksplisitte ligninger som beskriver energi-, masse- eller informasjonsstrømmer. Typiske
teknikker er differensialligninger, finite element-metoder (FEM) og computational fluid dynamics (CFD). Fordelen er at
modellene er transparente og muliggjør følsomhetsanalyser, men de krever inngående forståelse av prosessen og god kvalitet på
parametere. I norske prosessindustrier brukes slike modeller blant annet til å simulere varmebalanser i ovner, fukttransport i
trebaserte materialer og hydrodynamikk i fiskemerder.

\subsection{Datadrevne modeller}
Datadrevne modeller lærer systemets oppførsel direkte fra historiske eller sanntidsdata. Maskinlæring og statistiske metoder
kan identifisere mønstre uten å kjenne den underliggende fysikken. En digital skygge kan trenes på tidsserier fra sensorer for
å predikere avvik i produksjonen. Fordelen er rask implementering når rike datasett finnes, men modellene kan bli sårbare for
driftsendringer og må overvåkes for skjevheter.

\subsection{Hybride modeller og ko-simulering}
I mange digitale tvillinger kombineres fysikkbaserte og datadrevne komponenter. En hybrid modell kan bruke førsteprinsipper for
energi- og materialbalanser, mens maskinlæring estimerer friksjonstap eller operatørpåvirkning som er vanskelig å beskrive
analytisk. Ko-simulering gjør det mulig å koble sammen flere spesialiserte modeller i en helhetlig tidslinje, for eksempel når
mekanikk, termodynamikk og styringslogikk må løses samtidig \citep{boschert2018digital}. Denne kombinasjonen gir robusthet og
fleksibilitet, men krever tydelige API-kontrakter, delte dataskjema og versjonskontroll av hvert delsystem.

\subsection{Flerfidelitetsstrategier}
Flerfidelitetsmodellering kombinerer raske, grovkornede modeller med detaljerte høyfidelitetsmodeller for kritiske delsystemer.
Lavfidelitetsmodellen gir raske scenarioberegninger og støtte til beslutninger med stramme tidsfrister, mens høyfidelitetsmodellen
brukes til kalibrering og validering av sentrale parametere \citep{kennedy2000predicting}. Strategien er særlig nyttig i norsk
prosess- og energisektor der tilgangen til sensordata varierer mellom installasjoner \citep{sintef2021digital}. Et vellykket
flerfidelitetsoppsett krever at teamet:
\begin{itemize}
    \item definerer hvilke variabler som skal utveksles mellom modellene og hvordan usikkerhet skal rapporteres,
    \item etablerer en synkroniseringsplan for når høyfidelitetsmodellen skal oppdateres og hvordan endringene mates inn i
    lavfidelitetsmodellen,
    \item dokumenterer toleranser for avvik slik at driftsorganisasjonen vet når det er nødvendig med ny kalibrering eller
    eksperimentelle målinger.
\end{itemize}

\subsection{Case: Flerfidel modell for subsea-kompressorer}
Et norsk leverandørkonsortium har utviklet en digital tvilling for subsea-kompressorer på sokkelen. Plattformen kombinerer en
hurtig maskinlæringsmodell som estimerer produksjon og energiforbruk fra tilgjengelige trykk- og temperaturmålinger, med en
høyfidel CFD-modell som simulerer detaljerte turbulenseffekter i kompressoren. Hver natt kjøres CFD-modellen mot oppdaterte
operasjonsdata for å korrigere parametere i hurtigmodellen. Resultatene deles med driftsteamet gjennom et dashboard der
avvik merkes når usikkerheten overstiger definerte grenser. Prosjektet viser hvordan flerfidelitetsstrategier gir bedre
tilgjengelighet og vedlikeholdsplanlegging samtidig som modellene er dokumentert og revideres i samarbeid mellom operatør og
teknologipartnere \citep{sintef2021digital}.

\subsection{Vurdering av modellvalg}
Når et paradigme skal velges, bør teamet diskutere hvor kritisk forklarbarhet er, hvilke datakilder som er tilgjengelige og hvor
raskt modellen må oppdateres. Tabell~\ref{tab:kap02-modellvalg} gir et utgangspunkt for å sammenligne alternativer og velge en
portefølje av modeller som utfyller hverandre.

\begin{table}[ht]
    \centering
    \caption{Sammenligning av modelleringsparadigmer for digitale tvillinger.}
    \label{tab:kap02-modellvalg}
    \begin{tabular}{p{0.2\textwidth}p{0.27\textwidth}p{0.24\textwidth}p{0.23\textwidth}}
        \toprule
        \textbf{Paradigme} & \textbf{Styrker} & \textbf{Utfordringer} & \textbf{Typisk norsk case} \\
        \midrule
        Fysikkbasert & Forklarbare sammenhenger og mulighet for sensitivitetstester. & Krever detaljerte parametere og høy beregningskostnad. & Energiproduksjon med krav til termisk balanse. \\
        Datadrevet & Rask modellering når historiske data er rike. & Sårbar for konseptdrift og bias i data. & Produksjonslinjer med omfattende sensordekning. \\
        Hybrid & Kombinerer robusthet og fleksibilitet gjennom ko-simulering. & Krever koordinering av grensesnitt og felles semantikk. & Integrerte olje- og gassanlegg med flere disipliner. \\
        Agent-/hendelsesbasert & Fanger interaksjon mellom aktører og logistikkflyt. & Vanskelig å kalibrere uten detaljerte prosesslogger. & Transport- og beredskapsøvelser på lufthavner. \\
    \end{tabular}
\end{table}

I praksis bør valget dokumenteres i en modelljournal som beskriver antagelser, datakrav og ansvarlige personer for videre vedlikehold
\citep{iso23247-2021}. Dokumentér alltid hvilke måledata som trengs for å holde modellen presis over tid og hvordan modellene skal
gjennomgås i fagfelleprosesser.

\section{Modellintegrasjon og kalibrering}
Valgt modell må kobles til dataflyten som ble kartlagt tidligere. Integrasjon handler både om teknisk infrastruktur og
organisatorisk forankring. Kalibrering sikrer at modellen forblir relevant når systemet endrer seg.

\subsection{Integrasjonsmønstre mot datakilder}
Modellen kan oppdateres batchvis fra historiske datalagre eller kontinuerlig via hendelsesstrømmer. Et vanlig mønster er å bruke
en meldingskø eller et datamesh som mellomlag, slik at flere modeller kan abonnere på samme datasett uten å skape tette koblinger
til kildesystemene. Edge-komponenter håndterer ofte aggregering og filtrering før data sendes til skybaserte analyseplattformer.

\subsection{Sanntidsoppdatering og orkestrering}
For digitale tvillinger som støtter operativ beslutningstaking må modellene ha mekanismer for å oppdatere tilstandsvariabler i
sanntid. Dette kan løses med orkestreringsverktøy som støtter versjonering av modeller, utrulling i containere og overvåkning av
beregningstider. Viktige indikatorer er latens fra sensor til modell, datakvalitet og hvilken grad modellen brukes i kontrollsløyfer.

\subsection{Kalibreringsstrategier}
Parameteridentifikasjon kan gjøres manuelt ved å justere parameterne basert på eksperterfaring, eller automatisk ved hjelp av
optimaliseringsalgoritmer som minimerer forskjellen mellom modell og målinger. Vanlige metoder er minste kvadrater,
Bayesiansk oppdatering eller Kalman-filtre. For systemer som endrer seg gradvis kan modellreduksjon og adaptive filtre holde
beregningstidene nede uten å tape presisjon. Tabell~\ref{tab:kap02-kalibrering} viser hvordan ulike kalibreringsteknikker kan
kombineres for å støtte flerfidelitetsmodeller og operativ drift \citep{kennedy2000predicting}.

\begin{table}[ht]
    \centering
    \caption{Oversikt over kalibreringsmetoder for digitale tvillinger.}
    \label{tab:kap02-kalibrering}
    \begin{tabular}{p{0.2\textwidth}p{0.32\textwidth}p{0.2\textwidth}p{0.22\textwidth}}
        \toprule
        \textbf{Metode} & \textbf{Formål} & \textbf{Når brukes den?} & \textbf{Typisk dokumentasjon} \\
        \midrule
        Minste kvadrater & Justere parametere basert på referansemålinger. & Ved innkjøring av nye sensorer eller komponenter. & Måleserier, residuallogg og parameteroversikt. \\
        Bayesiansk oppdatering & Kombinere historisk kunnskap med nye observasjoner. & Når usikkerhet skal uttrykkes eksplisitt og modeller skal sammenliknes. & Prior- og posteriorfordelinger samt versjonslogg. \\
        Kalman-filtre & Sanntidsestimater av tilstand og støy. & I operativ drift med streamingdata og krav til rask respons. & Konfigurasjon av filter, kovariansmatriser og alarmintervaller. \\
        Eksperimentell design & Planlegge testkampanjer for flerfidelitetsmodeller. & Før modelloppdateringer i laboratorier eller testfelt. & Testplan, datakvalitetsprotokoll og risikovurdering. \\
    \end{tabular}
\end{table}

Dokumentasjonen må vise hvilke datasett som ligger til grunn, hvordan datakvalitet er vurdert og hvilke roller som godkjenner nye
parameterverdier før de tas i bruk i produksjon.

\subsection{Case: Digital tvilling for fjernvarme i Oslo}
Fortum Oslo Varme har utviklet en digital tvilling for å optimalisere energiproduksjon og distribusjon i fjernvarmenettet.
Modellen kombinerer hydrauliske ligninger for rørnettet med maskinlæringsmodeller som predikerer varmebehov basert på vær,
bygningstyper og historisk forbruk. Integrasjonen skjer via en datastrøm fra sensorer i kundesentraler og produksjonsanlegg til
et skybasert kontrollrom. Kalibreringen utføres daglig ved å sammenlikne modellprediksjoner med faktiske returtemperaturer, og
parametere justeres automatisk når avvik overstiger definerte terskler. Caset viser hvordan samarbeid mellom energiselskap,
teknologipartnere og kommune gir en robust modell som støtter både operativ drift og langsiktige investeringsbeslutninger.

\subsection{Anbefalt arbeidsflyt for team}
\begin{enumerate}
    \item Kartlegg hvilke datakilder som skal kobles til og etabler nødvendige API-er eller databrokere.
    \item Implementer monitorering som fanger avvik mellom modell og observasjoner i sanntid.
    \item Planlegg regelmessige kalibreringssykluser og dokumentér endringer i parametere og antagelser.
\end{enumerate}

\section{Modelldokumentasjon og styring}
God dokumentasjon sikrer at digitale tvillinger kan forvaltes over tid og at beslutninger er etterprøvbare. ISO~23247 beskriver hvordan modellbeskrivelser, datakataloger og styringsrutiner bør struktureres for produksjonsnære tvillinger \citep{iso23247-2021}. Ved å etablere en felles dokumentasjonsprosess blir det enklere å dele modeller på tvers av fagmiljø og følge opp krav fra myndigheter og industripartnere.

\subsection{Kjerneartefakter}
Hvert modelloppsett bør følges av en artefaktsamling som minimum inneholder:
\begin{itemize}
    \item \textbf{Modelljournal} med formål, antagelser, matematiske representasjoner og referanse til opplæringsdata.
    \item \textbf{Datakatalog} som beskriver kilder, oppdateringsfrekvens, kvalitetsindikatorer og tilgangsnivå.
    \item \textbf{Beslutningslogg} som kobler modellresultater til tiltak, ansvarlige personer og godkjenningstidspunkt.
    \item \textbf{Risikovurdering} som fanger opp driftsavvik, cybersikkerhetskrav og konsekvenser av modellfeil.
\end{itemize}

\subsection{Versjonskontroll og sporbarhet}
Alle modeller bør ligge i et versjonsstyrt repositorium der kode, parametere og dokumentasjon utvikles samlet. Metadata for hver versjon må beskrive hvilke datasett og kalibreringsmetoder som er brukt, samt referanser til godkjenning og testresultater. For hybride og flerfidelitetsmodeller innebærer dette at også grensesnittfiler og transformasjoner sjekkes inn, slik at ko-simulering kan reproduseres ved behov \citep{boschert2018digital}. Kombiner gjerne Git-baserte prosesser med automatisert rapportering fra modellovervåkingen for å vise status i sanntid.

\subsection{Sjekkliste før fagfellegjennomgang}
Før en modell distribueres til undervisning eller pilotering, bør teamet kontrollere følgende punkter:
\begin{enumerate}
    \item Alle kilder og referanser er oppdatert i modelljournalen, og versjonsnummer samsvarer med distribuerte pakker.
    \item Kalibreringsresultater og usikkerhetsanalyser er lagret sammen med underliggende datasett og beskrivelser av kvalitetssikring.
    \item Tiltak for sikker tilgang, personvern og beredskap er dokumentert, inkludert roller og kontaktpunkter for hendelseshåndtering.
    \item Plan for kontinuerlig forbedring er definert med milepæler, måleparametere og ansvarlig fagressurs.
\end{enumerate}

\section{Norske politiske rammer}
Digitale tvillinger i Norge utvikles innenfor et politisk landskap som legger tydelige føringer for hvordan data skal forvaltes, deles og brukes. Regjeringens datastrategi for offentlig sektor legger vekt på åpne, tilgjengelige og gjenbrukbare data som skal styrke innovasjon og effektivisering \citep{regjeringen2022datastrategi}. I tillegg beskriver stortingsmeldingen \emph{Data som ressurs} hvordan sektorer må samhandle gjennom felles prinsipper for datadeling, sikkerhet og personvern \citep{meldst22datasomressurs}. Oversikten nedenfor erstatter TikZ-illustrasjonen og viser hvordan europeiske, nasjonale og sektorspesifikke initiativ henger sammen når virksomheter planlegger digitale tvillinger:
\begin{itemize}
    \item \textbf{Europeisk nivå:} Datarom, Gaia-X og sektorspesifikke reguleringer (energi, transport, helse) setter rammer for interoperabilitet og sikkerhet.
    \item \textbf{Nasjonalt nivå:} Regjeringens datastrategi, Digitaliseringsdirektoratets retningslinjer og sektormeldinger definerer politikk, finansiering og samarbeidsmodeller.
    \item \textbf{Sektornivå:} Veiledere fra NVE, Samferdselsdepartementet, Helsedirektoratet m.fl. oversetter krav til konkrete tiltak i prosjektene.
\end{itemize}

\subsection{Statlige føringer og standardisering}
EU sitt arbeid med datarom og Gaia-X gir retningslinjer for interoperabilitet, sikker tilgang og styring av dataøkosystem \citep{eu2020circulareconomy}. Disse prinsippene videreføres i nasjonale strategier og i oppfølgingen av personvern-, sikkerhets- og energilovgivning. For digitaliseringsprosjekter i offentlig sektor betyr det at arkitekturen må støtte datadeling på tvers av etater, samtidig som den ivaretar krav til informasjonssikkerhet gjennom standarder som ISO~27001 og NIS2. NVE og Samferdselsdepartementet stiller tilsvarende krav i sektorveiledninger for energi og transport \citep{nve2023nettplan,avinor2022digital}.

\subsection{Case: Statnett sitt nettplanleggingsprogram}
Statnett bruker digitale tvillinger til å planlegge nettutbygging og driftsoptimalisering i takt med økende elektrifisering. Plattformen integrerer kraftsystemmodeller, sanntidsmålinger og scenarioer for energioverganger og må følge både energiloven og nye EØS-krav til datasamarbeid \citep{statnett2023digital}. Caset illustrerer hvordan politiske føringer styrer både modellstrukturen og arbeidsprosessene.

\begin{table}[ht]
    \centering
    \caption{Regulatoriske og tekniske komponenter i Statnett sitt nettplanleggingsprogram.}
    \label{tab:kap02-statnett}
    \begin{tabular}{p{0.33\textwidth}p{0.57\textwidth}}
        \toprule
        \textbf{Komponent} & \textbf{Beskrivelse} \\
        \midrule
        Regulatorisk ramme & Energimyndighetenes konsesjonskrav, NVE sin veileder for nettplanlegging og krav til samfunnsøkonomiske analyser. \\
        Dataintegrasjon & PMU-målinger og SCADA-data kobles med langsiktige forbruksprognoser og markedsdata. \\
        Beslutningsfora & Tverretatlige møter med NVE og OED hver kvartal for å evaluere scenarioer og prioriteringer. \\
        Effektmåling & Reduserte flaskehalser, bedre koordinering med regionale nettselskap og dokumentert klimanytte i investeringsbeslutninger. \\
        Kompetansebygging & Kurs i regulatoriske krav og modellbruk for Statnett-ansatte og samarbeidspartnere. \\
        \bottomrule
    \end{tabular}
\end{table}

Caset viser hvordan systemkart og modellvalg må reflektere både tekniske og regulatoriske perspektiver. Ved å knytte datastrømmer til konkrete konsesjonsprosesser kan Statnett dokumentere hvordan tiltak gir effekt og samtidig ivareta krav til forsyningssikkerhet.

\subsection{Case: Avinor sin lufthavntvilling}
Avinor utvikler digitale tvillinger for å koordinere kapasitetsplanlegging, energibruk og passasjerlogistikk på tvers av norske lufthavner \citep{avinor2022digital}. Modellene bygger på reiseinformasjon, værdata og sanntidsmålinger fra terminalene, og må samsvare med nasjonale mål om utslippskutt og universell utforming. I tillegg følges kravene i nasjonal transportplan og EASA-regelverk for sikkerhet.

\begin{table}[ht]
    \centering
    \caption{Nøkkelfunn fra Avinor sitt fagprogram for digitale tvillinger.}
    \label{tab:kap02-avinor}
    \begin{tabular}{p{0.34\textwidth}p{0.56\textwidth}}
        \toprule
        \textbf{Dimensjon} & \textbf{Observasjoner} \\
        \midrule
        Datagrunnlag & Kombinerer passasjerdata, bagasjehåndtering, energimålinger og værvarsel i felles dataplattform. \\
        Politisk kobling & Understøtter nasjonalt klimamål om 50\% reduksjon i utslipp fra lufthavndrift innen 2030 og krav om universell utforming. \\
        Operativ bruk & Scenarioanalyse for terminaldrift, bemanning og nye ruteplaner, samt simulering av beredskap. \\
        Resultater & 15\% redusert energibruk i utvalgte terminaler og bedre flyt for passasjerer ved toppbelastning. \\
        Deling & Faglig nettverk med regionale lufthavner og internasjonale partnere for å dele modeller og indikatorer. \\
        \bottomrule
    \end{tabular}
\end{table}

Eksemplet fremhever hvordan digitale tvillinger i transportsektoren må koordineres med både nasjonale strategier og europeiske sikkerhetskrav, og hvordan modellene blir en arena for samarbeid mellom ingeniører, planleggere og myndigheter.

\section{Refleksjonsspørsmål og øvinger}
\begin{enumerate}
    \item Lag et systemkart for en valgt industriell prosess.
    \item Diskuter fordeler og ulemper ved å kombinere fysikkbaserte og datadrevne modeller.
    \item Ta utgangspunkt i fjernvarme-caset og skisser hvordan kalibreringssløyfen kan overvåkes og forbedres over ett år.
\end{enumerate}
