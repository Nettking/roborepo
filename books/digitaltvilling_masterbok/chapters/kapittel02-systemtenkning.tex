\chapter{Systemtenkning og modellering}

% Notat (2024-07-16): Konvertert systemkart og kausalsløyfe til TikZ med tilhørende metadata og alt-tekst.

\section{Læringsmål}
\begin{itemize}
    \item Analysere komplekse systemer ved hjelp av systemtenkning.
    \item Vurdere ulike modelleringsstrategier for digitale tvillinger.
    \item Beskrive hvordan modeller kobles til måledata og styringssystemer.
\end{itemize}

\section{Systemperspektiv}
Systemtenkning starter med å forstå hvilke deler av virkeligheten som påvirker hverandre og hvordan verdistrømmer beveger seg gjennom systemet. Første steg er å definere klare systemgrenser, identifisere interessenter og beskrive hva de forsøker å oppnå. Deretter kan vi visualisere samspillet mellom teknologi, prosesser og mennesker ved hjelp av systemkart, påvirkningsdiagrammer og kausale sløyfer. Figurene under gir to typiske fremstillinger for en digital tvilling i en norsk industribedrift.

\textbf{Nøkkelspørsmål når systemperspektivet etableres:}
\begin{itemize}
    \item Hvilke organisatoriske enheter og tekniske komponenter inngår i systemet?
    \item Hvilke datakilder, beslutninger og tilbakemeldingsløp knytter dem sammen?
    \item Hvilke målkonflikter kan oppstå mellom interessentene?
\end{itemize}

\subsection{Systemkart for produksjonslinje med digital tvilling}
% Alt-tekst: support/figurer/metadata/kap02-systemkart-v1.alt.md
\begin{figure}[ht]
    \centering
    \resizebox{\textwidth}{!}{\input{../support/figurer/kilder/kap02-systemkart-v1.tikz}}
    \caption{Systemkart som viser hvordan data flyter fra felt via edge- og produksjonsstyringslag til analyseplattformer og digitale tvillingtjenester.}
    \label{fig:kap02-systemkart}
\end{figure}

Figur~\ref{fig:kap02-systemkart} illustrerer et typisk informasjonsløp der feltnivå, edge-infrastruktur og produksjonsstyringssystemer er tydelig gruppert. Historiske data kombineres med analyseplattformen for å oppdatere den digitale tvillingen, som igjen leverer beslutningsstøtte til operatører, vedlikeholdsteam og ledelse. Når du lager et eget systemkart, noter eksplisitt hvilke datatyper som flyter mellom nodene, og marker hvor ansvar og eierskap ligger i hvert lag.

\subsection{Kausalsløyfe mellom vedlikehold og energibruk}
% Alt-tekst: support/figurer/metadata/kap02-kausal-v1.alt.md
\begin{figure}[ht]
    \centering
    \resizebox{0.92\textwidth}{!}{\input{../support/figurer/kilder/kap02-kausal-v1.tikz}}
    \caption{Forsterkende (grønn) og dempende (oransje) sammenhenger mellom planlagt vedlikehold, tilstandsovervåkning, nedetid, energiforbruk og produktkvalitet.}
    \label{fig:kap02-kausal}
\end{figure}

Kausalsløyfen i figur~\ref{fig:kap02-kausal} viser hvordan systemkart kan brukes til å fange både ønskede og uønskede tilbakemeldinger. Økt planlagt vedlikehold forbedrer sensorenes status, som reduserer risiko for uplanlagte stopp og stabiliserer energibruken. Et stabilt energinivå gir høyere produktkvalitet, noe som igjen påvirker vedlikeholdsstrategien gjennom læring og prioritering av tiltak. Når slike forhold beskrives eksplisitt, blir det enklere å diskutere scenarier med interessenter og identifisere hvor den digitale tvillingen bør levere mest verdi.

\textbf{Arbeidsmåte for å utvikle systemkart:}
\begin{enumerate}
    \item Start med en workshop hvor interessenter beskriver mål og smertepunkter.
    \item Tegn det overordnede systemkartet (som i Figur 2.1) med fokus på dataflyt og ansvar.
    \item Utvid kartet med kausale sløyfer (som i Figur 2.2) for å avdekke dynamikk og mulige ubalanser.
    \item Forankre kartene i virksomhetens enterprise-arkitektur og eksisterende prosesskart slik at språk og symboler er gjenkjennelige for organisasjonen.
\end{enumerate}

Den konseptuelle modellen fra systemkartet danner grunnlaget for videre modellering, enten du velger fysikkbaserte, datadrevne eller hybride tilnærminger i de følgende seksjonene.

\section{Modelleringsparadigmer}
Systemkartet gir en felles forståelse av hvilke fenomener som må representeres i en digital tvilling. Neste steg er å velge et
modelleringsparadigme som balanserer nøyaktighet, forklarbarhet og implementasjonskostnad. Masterstudenter må kunne vurdere
hvordan ulike typer modeller beskriver sammenhengene i systemet og hvilke beslutninger de støtter. I praksis innebærer dette å
kombinere domenekunnskap fra feltet med metoder fra matematikk, statistikk og informatikk.

\subsection{Fysikkbaserte modeller}
Fysikkbaserte modeller er bygd på eksplisitte ligninger som beskriver energi-, masse- eller informasjonsstrømmer. Typiske
teknikker er differensialligninger, finite element-metoder (FEM) og computational fluid dynamics (CFD). Fordelen er at
modellene er transparente og muliggjør følsomhetsanalyser, men de krever inngående forståelse av prosessen og god kvalitet på
parametere. I norske prosessindustrier brukes slike modeller blant annet til å simulere varmebalanser i ovner, fukttransport i
trebaserte materialer og hydrodynamikk i fiskemerder.

\subsection{Datadrevne modeller}
Datadrevne modeller lærer systemets oppførsel direkte fra historiske eller sanntidsdata. Maskinlæring og statistiske metoder
kan identifisere mønstre uten å kjenne den underliggende fysikken. En digital skygge kan trenes på tidsserier fra sensorer for
å predikere avvik i produksjonen. Fordelen er rask implementering når rike datasett finnes, men modellene kan bli sårbare for
driftsendringer og må overvåkes for skjevheter.

\subsection{Hybride modeller og ko-simulering}
I mange digitale tvillinger kombineres fysikkbaserte og datadrevne komponenter. En hybrid modell kan bruke førsteprinsipper for
energi- og materialbalanser, mens maskinlæring estimerer friksjonstap eller operatørpåvirkning som er vanskelig å beskrive
analytisk. Ko-simulering gjør det mulig å koble sammen flere spesialiserte modeller i en helhetlig tidslinje, for eksempel når
mekanikk, termodynamikk og styringslogikk må løses samtidig. Denne kombinasjonen gir robusthet og fleksibilitet, men krever
god styring av grensesnitt og versjoner.

\subsection{Vurdering av modellvalg}
Når et paradigme skal velges, bør teamet diskutere hvor kritisk forklarbarhet er, hvilke datakilder som er tilgjengelige og hvor
raskt modellen må oppdateres. Dokumentér alltid hvilke antagelser som ligger til grunn og hvilke måledata som trengs for å holde
modellen presis over tid.

\section{Modellintegrasjon og kalibrering}
Valgt modell må kobles til dataflyten som ble kartlagt tidligere. Integrasjon handler både om teknisk infrastruktur og
organisatorisk forankring. Kalibrering sikrer at modellen forblir relevant når systemet endrer seg.

\subsection{Integrasjonsmønstre mot datakilder}
Modellen kan oppdateres batchvis fra historiske datalagre eller kontinuerlig via hendelsesstrømmer. Et vanlig mønster er å bruke
en meldingskø eller et datamesh som mellomlag, slik at flere modeller kan abonnere på samme datasett uten å skape tette koblinger
til kildesystemene. Edge-komponenter håndterer ofte aggregering og filtrering før data sendes til skybaserte analyseplattformer.

\subsection{Sanntidsoppdatering og orkestrering}
For digitale tvillinger som støtter operativ beslutningstaking må modellene ha mekanismer for å oppdatere tilstandsvariabler i
sanntid. Dette kan løses med orkestreringsverktøy som støtter versjonering av modeller, utrulling i containere og overvåkning av
beregningstider. Viktige indikatorer er latens fra sensor til modell, datakvalitet og hvilken grad modellen brukes i kontrollsløyfer.

\subsection{Kalibreringsstrategier}
Parameteridentifikasjon kan gjøres manuelt ved å justere parameterne basert på eksperterfaring, eller automatisk ved hjelp av
optimaliseringsalgoritmer som minimerer forskjellen mellom modell og målinger. Vanlige metoder er minste kvadrater,
Bayesiansk oppdatering eller Kalman-filtre. For systemer som endrer seg gradvis kan modellreduksjon og adaptive filtre holde
beregningstidene nede uten å tape presisjon.

\subsection{Case: Digital tvilling for fjernvarme i Oslo}
Fortum Oslo Varme har utviklet en digital tvilling for å optimalisere energiproduksjon og distribusjon i fjernvarmenettet.
Modellen kombinerer hydrauliske ligninger for rørnettet med maskinlæringsmodeller som predikerer varmebehov basert på vær,
bygningstyper og historisk forbruk. Integrasjonen skjer via en datastrøm fra sensorer i kundesentraler og produksjonsanlegg til
et skybasert kontrollrom. Kalibreringen utføres daglig ved å sammenlikne modellprediksjoner med faktiske returtemperaturer, og
parametere justeres automatisk når avvik overstiger definerte terskler. Caset viser hvordan samarbeid mellom energiselskap,
teknologipartnere og kommune gir en robust modell som støtter både operativ drift og langsiktige investeringsbeslutninger.

\subsection{Anbefalt arbeidsflyt for team}
\begin{enumerate}
    \item Kartlegg hvilke datakilder som skal kobles til og etabler nødvendige API-er eller databrokere.
    \item Implementer monitorering som fanger avvik mellom modell og observasjoner i sanntid.
    \item Planlegg regelmessige kalibreringssykluser og dokumentér endringer i parametere og antagelser.
\end{enumerate}

% Oppdatert med utvidet prosa om modelleringsparadigmer, integrasjon, kalibrering og norsk case.

\section{Refleksjonsspørsmål og øvinger}
\begin{enumerate}
    \item Lag et systemkart for en valgt industriell prosess.
    \item Diskuter fordeler og ulemper ved å kombinere fysikkbaserte og datadrevne modeller.
    \item Ta utgangspunkt i fjernvarme-caset og skisser hvordan kalibreringssløyfen kan overvåkes og forbedres over ett år.
\end{enumerate}
