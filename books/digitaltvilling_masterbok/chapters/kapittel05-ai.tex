\chapter{Læring, optimalisering og kunstig intelligens}

\section{Læringsmål}
\begin{itemize}
    \item Forstå hvordan maskinlæring, optimalisering og kunstig intelligens støtter digitale tvillinger.
    \item Vurdere når dataassimilering og online læring er hensiktsmessig.
    \item Designe eksperimenter for å kombinere simulerings- og læringsmodeller.
\end{itemize}

\section{Maskinlæring i digitale tvillinger}
Maskinlæring gir digitale tvillinger evnen til å lære direkte fra data og forutse hvordan en fysisk prosess vil utvikle seg. I
starten av et prosjekt brukes ofte overvåket læring for å bygge en modell som kan estimere tilstandsvariabler eller nøkkelpara
metere som er vanskelige å måle direkte. Etter hvert som tvillingen tas i drift kan ikke-overvåket læring brukes til å oppdag
e nye driftstilstander og identifisere avvik som indikerer behov for justeringer i modellen. Forsterkende læring egner seg når
tvillingen skal anbefale beslutninger i et system med mange kombinasjoner av tiltak, slik som energistyring eller ruteplanlegg
ing. 

Når simuleringsmodeller er tunge å kjøre, benyttes surrogate modeller eller metamodeller for å approksimere resultatene raskt.
Disse bygges gjerne ved å trene en maskinlæringsmodell på data fra simuleringer og reelle observasjoner, slik at tvillingen kan
gi raske svar i interaktive situasjoner. Transfer learning gjør det mulig å gjenbruke læring fra én fabrikk til en annen ved å
tilpasse modellene til nye sensorer og prosessparametere. I norske konsern med flere lokasjoner er også federated learning aktu
elt; data forblir på hvert anlegg, men modeller oppdateres felles gjennom sikre aggregeringsmekanismer som ivaretar personvern
og forretningssensitiv informasjon.

\section{Optimalisering og beslutningsstøtte}
Optimalisering utnytter innsikten fra maskinlæringsmodellene og den fysiske simuleringen til å foreslå hvilke handlinger som gi
r best mulig resultat under gitte begrensninger. Modellprediktiv kontroll (MPC) er et sentralt rammeverk for digitale tvillinge
r fordi det kombinerer dynamiske prognoser med eksplisitte restriksjoner på produksjonskapasitet, energi og kvalitet. Maskinlær
ingen bidrar med oppdaterte prediksjoner av hvordan systemet reagerer, mens MPC-formuleringen sørger for at anbefalingene er go
dt innenfor sikkerhetsmarginer.

Når målfunksjonen er ujevn eller ikke-differensierbar, kan Bayesiansk optimalisering og genetiske algoritmer brukes for å finne
gode løsninger med få simuleringskjøringer. I scenarioer der optimalisering må skje kontinuerlig, eksempelvis i smart grid-drif
t, brukes gradientbaserte metoder og konveks optimalisering for å sikre responstid i sanntid. Å håndtere målkonflikter er ofte p
åkrevd: en digital tvilling for en industriell ovn må balansere energibruk, utslipp og produktkvalitet. Multiobjektiv-tilnærmin
ger og pareto-analyser gir beslutningstakere innsikt i hvilke kompromisser som er mulige.

\section{Dataassimilering og online oppdatering}
Dataassimilering gjør at digitale tvillinger holder tritt med den faktiske prosessen. Filtreringsteknikker som Kalman-filter, e
nssemble-Kalman og partikkelfilter kombinerer sensormålinger, historikk og modellprediksjoner til et best mulig estimat av til
standen. Når dataene er komplekse og høyfrekvente, kan hybride løsninger der filtrene opererer på aggregerte signaler supplert
med nevrale nettverk for feature-uttrekk holde beregningstiden nede.

Et sentralt tema er å håndtere konseptdrift, altså at relasjonene mellom variabler endrer seg over tid. Ved å overvåke performa
nce-metrikker og trigge re-trening av maskinlæringsmodellene i kontrollerte vinduer, opprettholdes balansen mellom stabilitet o
g fleksibilitet. Arkitekturmessig krever dette en oppdateringssløyfe som fanger opp nye datapakker, kvalitetssikrer dem og publ
iserer de oppdaterte modellene tilbake til tvillingen. Mange norske virksomheter har løst dette ved å kombinere Kubernetes-base
rte mikrotjenester, strømmeplattformer som Apache Kafka og modellregister som MLflow for å sikre sporbarhet.

\section{Fremvoksende praksiser for AI-drevne tvillinger}
Fagfellekommentarene fremhevet behovet for å beskrive hvordan moderne AI-tvillinger håndterer både datatilgang og distribusjon. Generative modeller, syntetiske datasett og edge-distribuerte komponenter gjør det mulig å løse utfordringer som begrenset datastrøm, krav til personvern og sanntidsrespons. Dette avsnittet oppsummerer tiltakene som ble prioritert i fagfelleløpet for kapittel~5.

\subsection{Generative modeller og syntetiske scenarier}
Foundation-modeller og andre generative teknikker brukes til å lage scenarioer for test og finjustering når historiske data ikke dekker alle relevante tilstander.\citep{bommasani2021opportunities} I digitale tvillinger betyr dette at man kan simulere sjeldne driftshendelser, lage datagrunnlag for trygg forsterkende læring eller anonymisere sensitive datasett før de deles i fagfellesamarbeid. For å bevare tilliten må syntetiske datasett merkes tydelig, og datainntaksløpet dokumenteres slik at både modell-eiere og kontrollorgan kan se hvilke deler av pipeline som er basert på generativt materiale. Når generative modeller brukes til å foreslå nye styringsstrategier, bør de kobles til tiltakene i Kapittel~6 om validering for å sikre at anbefalinger testes mot fysiske begrensninger før utrulling.

\subsection{Edge-distribuerte tvillinger}
Edge-intelligens er nødvendig der beslutninger må tas på millisekunder og nettverkstilkoblingen er begrenset, for eksempel i maritime operasjoner eller energimikrogrids.\citep{shi2016edge} En vanlig arkitektur er å la den sentrale plattformen håndtere langsiktig læring og flåtestyring, mens edge-noder kjører lette versjoner av modellene for lokal optimalisering og avviksdeteksjon. Fagfellepanelet anbefalte at vi beskriver hvordan modellversjoner og dataflyt synkroniseres mellom edge og sky: DevOps-teamet må definere hvilke signaler som trigges ved modellavvik, hvilke målinger som replikkeres tilbake til sentral datasjø, og hvordan sikkerhetsoppdateringer distribueres uten å stoppe produksjonen. Ved pilotering i norsk industri har det vært nyttig å kombinere container-orienterte orkestratorer (for eksempel K3s) med hendelseslogg i datasjøen slik at datagovernance og revisjon kan følge edge-endringene.

\section{Samspill mellom læring, optimalisering og assimilering}
De tre byggesteinene virker sammen i en lukket sløyfe: maskinlæring gir prognoser og modeller som beskriver systemet, dataassi
milering korrigerer modellen når virkeligheten avviker, og optimalisering omskaper innsikten til beslutninger. I praksis må sli
ke sløyfer designes slik at dataflyten er robust, at prosesseringen skjer i riktig rekkefølge, og at menneskelige operatører ha
r innsyn i hvorfor anbefalingene endres. En moden digital tvilling bør derfor inkludere dashboards som visualiserer hvilke måle
r som påvirker beslutningene, og varslingsmekanismer når usikkerheten overstiger forhåndsdefinerte terskler. Dette gjør det mul
ig å bygge tillit, for eksempel ved å dokumentere hvordan et bestemt sett med sensordata utløste en ny optimaliseringsstrategi
.

\section{Vurderingskriterier for AI-drevne tvillinger}
For å gjøre caseoppgaven i dette kapittelet etterprøvbar må studentene beskrive hvordan algoritmevalgene deres oppfyller krav t
il ytelse, robusthet og ansvarlighet. Rammeverk som \citet{ec2020trustworthyai} anbefaler at tekniske måltall kombineres med pro
sesskrav, slik at evalueringen dekker både modellkvalitet og styringsmekanismer rundt tvillingen.

\subsection{Fokusområder for evaluering}
\begin{itemize}
    \item \textbf{Ytelse og generalisering}: Dokumenter trenings- og valideringsoppsettet, inkludert kryssvalidering, usikkerhetsbånd og hvilke datasett som brukes til sluttkontroll. Angi terskler for akseptable verdier (for eksempel RMSE, MAPE eller F1-score) og hvordan de knyttes til beslutningene tvillingen skal støtte.
    \item \textbf{Robusthet og driftsoppfølging}: Vis hvordan modellen overvåkes for konseptdrift gjennom alarmer i MLOps-løpet og hvilke failsafe-mekanismer som trer inn dersom modellen avviker fra virkelige observasjoner. Beskriv testsett for stress- og feilsituasjoner, inkludert syntetiske scenarioer.
    \item \textbf{Etikk, etterlevelse og forklarbarhet}: Oppsummer hvilke regulatoriske krav og interne prinsipper som gjelder for caset. Knytt tiltak til styringsstrukturene i Kapittel~6 og vurder hvilke forklaringsmetoder (for eksempel SHAP, feature importance eller kontrafaktiske eksempler) som trengs for å gi innsikt til domeneekspertene.
\end{itemize}

\subsection{Matrise for algoritmevalg}
Tabellen under hjelper studentene å argumentere for hvorfor et algoritmevalg er passende og hvilke evidenser som må leveres. De
n kan fylles ut som del av prosjektlogg eller rapport og fungerer som kobling til vurderingsrubrikken i lærerveiledningen.

\begin{longtable}{p{0.23\textwidth}p{0.30\textwidth}p{0.41\textwidth}}
\toprule
\textbf{Algoritmekategori} & \textbf{Aktuelle scenarier i caset} & \textbf{Nøkkelkriterier for vurdering} \\
\midrule
\endfirsthead
\toprule
\textbf{Algoritmekategori} & \textbf{Aktuelle scenarier i caset} & \textbf{Nøkkelkriterier for vurdering} \\
\midrule
\endhead
Regresjon og ensemble-modeller (Random Forest, Gradient Boosting) & Tilstandsestimering, energiprognoser og kvalitetsmålinger i produksjon. & Rapporter RMSE/MAE, forklart varians og hvilke sensorer som bidrar mest. Beskriv hvordan modellen håndterer manglende data og klasseskeivhet. \\
\addlinespace
Sekvens- og tidsseriemodeller (LSTM, Temporal Fusion Transformer) & Sanntidsprognoser for last, vedlikeholdsbehov eller produksjonskapasitet. & Dokumenter MAPE eller SMAPE, forsinkelse i inferens og strategier for å håndtere konseptdrift (re-trening eller transfer learning). \\
\addlinespace
Forsterkende læring og MPC-hybrider & Autonome styringssløyfer, energibalansering og ruteoptimalisering. & Oppgi stabilitet i belønningsfunksjonen, antall brudd på sikkerhetsbegrensninger og hvordan policyer testes før utrulling. \\
\addlinespace
Bayesiansk optimalisering og surrogatmodeller & Parameterfinjustering av simuleringsmodeller eller eksperimentdesign. & Vis forbedring i forventet gevinst, antall nødvendige eksperimenter og usikkerhetsmarginer rundt anbefalte parametere. \\
\addlinespace
Anomali- og driftsdeteksjon (autoencoder, isolation forest) & Overvåking av sensorer, logistikkflyt eller sikkerhetshendelser. & Mål falsk positiv-rate, deteksjonstid og hvordan alarmer eskaleres til operasjonelle team. Forklar hvilke signalforklaringer som deles med fagpersoner. \\
\addlinespace
Generative modeller og foundation-plattformer & Scenario-testing, syntetiske data og prototyping der reelle data er begrenset eller sensitive. & Dokumenter datasettets opphav, kvalitetskontroller og hvordan syntetiske resultater merkes. Beskriv governance for modellopprinnelse og hvordan output verifiseres før beslutninger tas i drift. \\
\bottomrule
\end{longtable}

\subsection{Leveransekrav til caseoppgaven}
\begin{enumerate}
    \item Oppdater prosjektlogg eller fagfellelogg med valgt algoritme, evaluering og beslutning, slik at arbeidet kan revideres
    av andre team. Dokumenter prosessen i tråd med audit-prinsippene i \citet{raji2020closing}.
    \item Legg ved en teknisk vedleggsdel som beskriver datakilder, hyperparametere, versjonskontroll og automatiserte tester i MLOps-løpet. Knyt tiltakene til styringsprinsippene i Kapittel~7.
    \item Reflekter i sluttrapporten over hvordan modellen skal videreføres etter prosjektet: hvem eier ansvaret, hvilke indikator
    er skal overvåkes og hvilke beslutningsgrenser krever menneskelig godkjenning.
    \item Beskriv hvordan generative modeller, syntetiske datasett eller edge-komponenter eventuelt inngår i løsningen, og gjør rede for datasporing, ytelsesmålinger og kontroller som sikrer at tiltakene følger retningslinjene i Kapittel~6.
\end{enumerate}

\section{Industrieksempel: Optimal drift av et landbasert oppdrettsanlegg}
Et norsk oppdrettsanlegg med resirkulerende akvakultur (RAS) kombinerer sensorer for vannkvalitet, fôringssystem og fiskevelfe
rd med en digital tvilling som simulerer både biologiske og tekniske prosesser. Maskinlæring benyttes til å predikere vekstrate
r og oksygenbehov basert på kameradata og historiske fôringsmønstre. Optimaliseringslaget bruker disse prediksjonene til å best
emme fôringsstrategi og justering av vannstrømmer, innenfor begrensninger for energibruk og biosikkerhet. Dataassimilering fore
går gjennom en utvidet Kalman-prosess som oppdaterer tvillingens tilstandsestimat hver gang nye sensordata kommer inn. Når sili
konnivået stiger raskere enn forventet, flagger modellen avviket og justerer samtidig anbefalingene for filtreringskapasitet og
temperaturstyring. Operatører kan dermed ta informerte grep for å forhindre stress hos fisken og redusere utslipp til miljøet, s
amtidig som produksjonen holdes oppe.

\section{Refleksjonsspørsmål og øvinger}
\begin{enumerate}
    \item Velg et case og lag et dataflytskjema som viser hvordan maskinlæring, dataassimilering og optimalisering henger samm
en i tvillingen.
    \item Forklar med egne ord hvordan modellprediktiv kontroll kan dra nytte av oppdaterte maskinlæringsmodeller og filtrering
sdata.
    \item Lag et forslag til eksperimentoppsett for online læring med begrenset datatilgang, inkludert kriterier for når modell
ene skal re-trenes.
\end{enumerate}
